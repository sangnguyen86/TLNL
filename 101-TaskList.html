<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <!-- viewport-fit + dvh/svh cho iOS/Android, chống phóng to chữ -->
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>XƯỞNG SẢN XUẤT</title>

  <!-- Chỉ 1 bản Bootstrap để nhẹ và tránh xung đột -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">

  <!-- Tăng tốc kết nối đến GAS -->
  <link rel="preconnect" href="https://script.google.com" crossorigin>
  <link rel="dns-prefetch" href="https://script.google.com">
  <link rel="preconnect" href="https://www.gstatic.com" crossorigin>
  <link rel="dns-prefetch" href="https://www.gstatic.com">

  <style>
    /* ===== Reset & nền tối dịu mắt trên mobile ===== */
    :root { color-scheme: dark light; }
    html, body {
      height: 100%;
      margin: 0;
      -webkit-text-size-adjust: 100%;
      background: #0f1115;
      color: #e9eef5;
    }

    /* ===== Bố cục cột: header + nav + main(iframe) fill còn lại */
    body {
      display: flex;
      flex-direction: column;
      min-height: 100svh; /* svh = small viewport height (ổn định khi thanh URL iOS/Android thay đổi) */
    }
    header, nav { background: #0c0e12; }
    main {
      flex: 1 1 auto;       /* chiếm toàn bộ chiều cao còn lại */
      display: flex;
      min-height: 60svh;    /* đảm bảo có chiều cao tử tế nếu header dài */
    }

    /* ===== Title gọn cho điện thoại ===== */
    .site-title {
      font-weight: 700;
      letter-spacing: .2px;
      /* clamp: min 16px, ưu tiên 5vw, max 24px */
      font-size: clamp(16px, 5vw, 24px);
    }

    /* ===== Nav: co gọn & dễ chạm trên mobile ===== */
    .navbar { --bs-navbar-nav-link-padding-x: .6rem; }
    .navbar .nav-link,
    .navbar .dropdown-item { min-height: 40px; }

    /* Cho nav cuộn ngang khi quá dài trên điện thoại thay vì bọc xuống dòng xấu */
    @media (max-width: 576px) {
      .navbar-nav {
        flex-wrap: nowrap;
        overflow-x: auto;
        white-space: nowrap;
        -webkit-overflow-scrolling: touch;
        gap: .25rem;
      }
      .navbar .dropdown-menu { position: static; } /* dropdown hiển thị thân thiện trong menu mobile */
    }

    /* ===== Khung iframe fill diện tích còn lại ===== */
    .iframe-wrap {
      position: relative;
      flex: 1 1 auto;     /* fill theo chiều cao main */
      width: 100%;
      overflow: hidden;
      background: #0a0c10;
      border-top: 1px solid rgba(255,255,255,.06);
    }
    .fast-iframe {
      display: block;
      width: 100%;
      height: 100%;
      border: 0;
      opacity: 0;                 /* ẩn tới khi onload để tránh nhấp nháy */
      transition: opacity .25s ease;
    }

    /* ===== Skeleton chờ iframe ===== */
    .skeleton {
      position: absolute; inset: 0;
      display: grid; place-items: center;
      background: linear-gradient(90deg, rgba(255,255,255,.04), rgba(255,255,255,.08), rgba(255,255,255,.04));
      background-size: 200% 100%;
      animation: shimmer 1.25s linear infinite;
    }
    @keyframes shimmer { 0% {background-position: 200% 0} 100% {background-position: -200% 0} }
    .skeleton .spinner-border { width: 2rem; height: 2rem; }

    /* ===== Màu dropdown tối & hover dễ thấy ===== */
    .navbar-dark .dropdown-menu { background:#141820; border-color: rgba(255,255,255,.08); }
    .dropdown-item { color:#e6ebf1; }
    .dropdown-item:hover { background:#1c2230; color:#fff; }

    /* ===== Nút toggle lớn hơn chút cho ngón tay ===== */
    .navbar-toggler { padding: .4rem .6rem; }

    /* ===== Tối ưu motion người dùng ===== */
    @media (prefers-reduced-motion: reduce) {
      .fast-iframe { transition: none; }
      .skeleton { animation: none; }
    }
  </style>
</head>
<body>
  <!-- Header -->
  <header class="py-2 border-bottom">
    <div class="container-fluid text-center">
      <h1 class="site-title text-primary m-0">BP CƠ ĐIỆN - LÒ HƠI - MÁY NÉN KHÍ</h1>
    </div>
  </header>

  <!-- Navbar -->
  <nav class="navbar navbar-expand-lg navbar-dark border-bottom">
    <div class="container-fluid">
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar-content" aria-controls="navbar-content" aria-expanded="false" aria-label="Mở menu">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse" id="navbar-content">
        <ul class="navbar-nav me-auto mb-2 mb-lg-0">
          <li class="nav-item"><a class="nav-link active" href="https://sangnguyen86.github.io/TLNL/100-Main.html">TRANG CHỦ</a></li>

          <!-- CƠ ĐIỆN -->
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" data-bs-toggle="dropdown" data-bs-auto-close="outside">TỔ CƠ ĐIỆN</a>
            <ul class="dropdown-menu dropdown-menu-dark shadow">
              <li><a class="dropdown-item" href="https://sangnguyen86.github.io/TLNL/101-TaskList.html">BẢNG CÔNG VIỆC</a></li>
              <li><a class="dropdown-item" href="https://sangnguyen86.github.io/TLNL/102-PlanList.html">KẾ HOẠCH DỰ ÁN</a></li>
              <li><hr class="dropdown-divider"></li>
              <li class="dropend">
                <a class="dropdown-item dropdown-toggle" href="#" data-bs-toggle="dropdown">BÁO CÁO &amp; CHỈ SỐ</a>
                <ul class="dropdown-menu dropdown-menu-dark shadow">
                  <li><a class="dropdown-item" href="https://sangnguyen86.github.io/TLNL/104-TaskReport.html">BÁO CÁO CÔNG VIỆC</a></li>
                  <li><a class="dropdown-item" href="https://sangnguyen86.github.io/TLNL/105-WaterRecord.html">GHI CHỈ SỐ NƯỚC</a></li>
                  <li><a class="dropdown-item" href="https://sangnguyen86.github.io/TLNL/107-MotorRecord.html">GHI CHỈ SỐ DÒNG ĐIỆN</a></li>
                </ul>
              </li>
              <li class="dropend">
                <a class="dropdown-item dropdown-toggle" href="#" data-bs-toggle="dropdown">PHÂN CÔNG</a>
                <ul class="dropdown-menu dropdown-menu-dark shadow">
                  <li><a class="dropdown-item" href="#">CÔNG VIỆC HẰNG NGÀY</a></li>
                  <li><a class="dropdown-item" href="#">PHÂN CÔNG KHÁC</a></li>
                  <li><a class="dropdown-item" href="#">KHÁC</a></li>
                </ul>
              </li>
            </ul>
          </li>

          <!-- LÒ HƠI -->
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" data-bs-toggle="dropdown" data-bs-auto-close="outside">TỔ LÒ HƠI</a>
            <ul class="dropdown-menu dropdown-menu-dark shadow">
              <li><a class="dropdown-item" href="#">Link 1</a></li>
              <li><a class="dropdown-item" href="#">Link 2</a></li>
              <li><a class="dropdown-item" href="#">Link 3</a></li>
              <li class="dropend">
                <a class="dropdown-item dropdown-toggle" href="#" data-bs-toggle="dropdown">REPORTS</a>
                <ul class="dropdown-menu dropdown-menu-dark shadow">
                  <li><a class="dropdown-item" href="#">Report 1</a></li>
                  <li><a class="dropdown-item" href="#">Report 2</a></li>
                  <li><a class="dropdown-item" href="#">Report 3</a></li>
                </ul>
              </li>
            </ul>
          </li>

          <!-- Link nhanh -->
          <li class="nav-item"><a class="nav-link" href="https://sangnguyen86.github.io/TLNL/103-MaintList.html">BẢO TRÌ BẢO DƯỠNG</a></li>
          <li class="nav-item"><a class="nav-link" href="https://sangnguyen86.github.io/TLNL/204-Than.html">THAN ĐÁ</a></li>
          <li class="nav-item"><a class="nav-link" href="https://sangnguyen86.github.io/TLNL/106-Suggestion.html">ĐỀ XUẤT VẬT TƯ</a></li>
        </ul>

        <!-- Search -->
        <form class="d-flex ms-auto" role="search">
          <div class="input-group">
            <input class="form-control border-0" type="search" placeholder="Tìm kiếm" aria-label="Search">
            <button class="btn btn-primary border-0" type="submit">Tìm</button>
          </div>
        </form>
      </div>
    </div>
  </nav>

  <!-- Nội dung: iframe GAS -->
  <main>
    <section class="iframe-wrap" id="iframeWrap">
      <!-- Skeleton khi chờ iframe -->
      <div class="skeleton" id="skeleton">
        <div class="text-center">
          <div class="spinner-border text-light" role="status" aria-hidden="true"></div>
          <div class="mt-2 text-white-50">Đang tải kế hoạch bảo trì…</div>
        </div>
      </div>

      <iframe
        id="gasFrame"
        class="fast-iframe"
        title="Kế hoạch bảo trì bảo dưỡng"
        loading="lazy"
        referrerpolicy="no-referrer-when-downgrade"
        allow="fullscreen"
        sandbox="allow-scripts allow-same-origin allow-forms"
        ></iframe>
    </section>
  </main>

  <!-- Bootstrap JS -->
  <script defer src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    // URL Web App GAS của bạn
    const IFRAME_SRC = "https://script.google.com/macros/s/AKfycbyHry8Kk9_0ZyCfy3nZhVIrxKrENmSf5vsnPW-xxoUUbxRuOg1wYcUjdnT9x3i9urw/exec";
	<!--https://script.google.com/macros/s/AKfycbw-dxt1WJ-cQWxe8r5MMa6Cu4h1_rzcb0dBNig3k1BQwRCzlRXHYan1THUb3dSZs-24Wg/exec" height="800px" width="100%"-->
    // Lazy gán src khi khối iframe vào tầm nhìn -> nhanh trang đầu
    function mountIframeWhenVisible() {
      const frame = document.getElementById('gasFrame');
      const skel  = document.getElementById('skeleton');

      if (!('IntersectionObserver' in window)) {
        frame.src = IFRAME_SRC;
        frame.addEventListener('load', () => {
          skel.style.display = 'none';
          frame.style.opacity = '1';
        });
        return;
      }

      const io = new IntersectionObserver((entries, obs) => {
        const ent = entries[0];
        if (ent && ent.isIntersecting) {
          frame.src = IFRAME_SRC;
          frame.addEventListener('load', () => {
            skel.style.display = 'none';
            frame.style.opacity = '1';
          }, { once: true });
          obs.disconnect();
        }
      }, { root: null, rootMargin: '200px 0px', threshold: 0.01 });

      io.observe(document.getElementById('iframeWrap'));
    }

    // Khởi động
    document.addEventListener('DOMContentLoaded', mountIframeWhenVisible);
  </script>
</body>
</html>
   
	




