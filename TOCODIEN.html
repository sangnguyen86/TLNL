<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>CỔNG TỔ CƠ ĐIỆN</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    html, body { height: 100%; }
    body { margin:0; display:flex; flex-direction:column; background:#121416; color:#e9ecef; }
    .content { flex:1; display:flex; flex-direction:column; }
    #frame { flex:1; border:0; width:100%; background:#0b0c0e; }
    .list-group-item.active { background:#0d6efd; border-color:#0d6efd; }
    .loading { position:absolute; inset:0; display:none; align-items:center; justify-content:center; background:rgba(0,0,0,.25); z-index:10; }
    .loading.show { display:flex; }
  </style>
</head>
<body>
  <!-- Header -->
  <nav class="navbar navbar-dark bg-dark shadow-sm">
    <div class="container-fluid">
      <span class="navbar-brand mb-0 h1">CỔNG TỔ CƠ ĐIỆN</span>
    </div>
  </nav>

  <!-- Danh sách link + khung xem -->
  <div class="content position-relative">
    <div class="loading" id="loading"><div class="spinner-border" role="status" aria-hidden="true"></div><span class="ms-2">Đang tải...</span></div>

    <div class="container py-3">
      <div class="row g-3">
        <div class="col-12">
          <div class="list-group list-group-horizontal-md flex-wrap" id="linkList">
            <!-- Render bằng JS từ mảng data -->
          </div>
        </div>
        <div class="col-12">
          <iframe id="frame" title="Nội dung"></iframe>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Dữ liệu theo cấu trúc bảng: Tên + Src
    const PAGES = [
      { name: 'MÔ TẢ CÔNG VIỆC VÀ PHÂN CÔNG', src: 'https://script.google.com/macros/s/AKfycbyK1iye0cek7seY7kqmGOb6V1MYVy_Ue43q2dY2KFeby329xHaQBtFj2WdDweW46NLA/exec' },
      { name: 'BẢNG CÔNG VIỆC',                 src: 'https://script.google.com/macros/s/AKfycbgyHry8kK9_0zyCyf3nZhVIrxKrFENmSf5vsnPW-xxoUUbxRuOg1wYCJdjnT9x3Pjuwr/exec' },
      { name: 'KẾ HOẠCH DỰ KIẾN',               src: 'https://script.google.com/macros/s/AKfycby6kstI0lY03dARrTxXxuDd_83JEt2x7AzFzufPdOmxuz4xS0M35tsGn41z9CGXA-C/exec' },
      { name: 'KH BẢO TRÌ BẢO DƯỠNG',           src: 'https://script.google.com/macros/s/AKfycbxeuGMrHIOt03JdRXAeU-JBQn-hoOFSOSuX1_qH9VAGZ6dxQ8HQqnb9W9Gn5ZOH1mCt9g/exec' },
      { name: 'GHI CHỈ SỐ NƯỚC',                src: 'https://script.google.com/macros/s/AKfycbxjuYfLY1TdQ6DoD3qveXAXboEeuo85XeT8RhWkzVlH0Qaqezlz75xez1V0rcRjdt7nrUqQ/exec' },
      { name: 'BÁO CÁO CÔNG VIỆC',              src: 'https://script.google.com/macros/s/AKfycbszwCj7p9fY2DMmeoEMnmdSmG__XTMAde0Bi7GLPR-r5qPX0pvipkT7GVdK3yd0wP0It/exec' },
      { name: 'ĐỀ XUẤT VẬT TƯ',                 src: 'https://script.google.com/macros/s/AKfycbzrrIMJ4NsymEMEV6EkOQy2qTH1ApZtdb4bn81sLPbCUE-upxwxIW-tyNW0wzAurmxV/exec' },
      { name: 'GHI CHỈ SỐ MÔ TƠ',               src: 'https://script.google.com/macros/s/AKfycbxpHonjpCZ9Vin4Z2ATGEPGD09XVZ8MI76M1LkueE3wIHWKG9_Yb_XeL1935VsnvrSthe/exec' },
    ];

    const linkList = document.getElementById('linkList');
    const frame = document.getElementById('frame');
    const loading = document.getElementById('loading');
    const LS_KEY = 'codien.active';

    function renderLinks(){
      linkList.innerHTML = '';
      PAGES.forEach((p, idx) => {
        const a = document.createElement('a');
        a.href = '#';
        a.className = 'list-group-item list-group-item-action';
        a.textContent = p.name;
        a.dataset.src = p.src;
        a.addEventListener('click', (e)=>{ e.preventDefault(); activate(p.src, a); });
        linkList.appendChild(a);
      });
    }

    function activate(src, el){
      if(!src) return;
      loading.classList.add('show');
      Array.from(linkList.children).forEach(c => c.classList.remove('active'));
      if(el) el.classList.add('active');
      frame.addEventListener('load', ()=> loading.classList.remove('show'), { once:true });
      frame.src = src;
      localStorage.setItem(LS_KEY, src);
      location.hash = encodeURIComponent(src);
    }

    // init
    renderLinks();
    const start = decodeURIComponent(location.hash.slice(1)) || localStorage.getItem(LS_KEY) || (PAGES[0] && PAGES[0].src);
    // Chọn đúng link active theo start
    const startEl = Array.from(linkList.children).find(a => a.dataset.src === start);
    activate(start, startEl);
  </script>
</body>
</html>

