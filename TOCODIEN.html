<!doctype html>
<!-- Giao diện TỔ CƠ ĐIỆN – phiên bản Cyber/Neon + tối ưu mobile + lazy-load iframe -->
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>TỔ CƠ ĐIỆN</title>

  <!-- Bootstrap & Icons -->
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/livecanvas-team/ninjabootstrap/dist/css/bootstrap.min.css" />
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css"/>

  <!-- ============================================
       CSS THEME & LAYOUT – Cyber / Neon style
       ============================================ -->
  <style>
    :root{
      --bg: #020617;            /* nền tổng thể – rất tối */
      --surface: #020617;       /* bề mặt chính */
      --surface-2: #020617;     /* vùng content */
      --surface-3: #020617;     /* nền iframe */
      --text: #e5e7eb;
      --muted: #9ca3af;

      --primary: #38bdf8;       /* cyan */
      --primary-600: #0ea5e9;
      --primary-200: #bae6fd;

      --border: #1f2937;
      --border-hover: #38bdf8;

      --bottom-bg: rgba(15,23,42,0.92);
      --bottom-border: #1e293b;
      --active-pill: rgba(15,118,190,0.24);

      --h-header: 60px;
      --gap-hb: 10px;
      --h-banner: 80px;
      --gap-bm: 14px;

      --radius: 10px;
      --banner-maxw: 1400px;
    }

    html, body{
      height: 100%;
      margin: 0;
    }
    body{
      background:
        radial-gradient(circle at 20% 0%, rgba(56,189,248,0.18), transparent 55%),
        radial-gradient(circle at 80% 100%, rgba(59,130,246,0.30), transparent 55%),
        #020617;
      color: var(--text);
      display:flex;
      flex-direction:column;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }

    /* ================= HEADER (sticky 1) ================= */
    .top-header{
      position: sticky;
      top: 0;
      z-index: 1040;
      height: var(--h-header);
      display:flex;
      align-items:center;
      justify-content:center;
      background: linear-gradient(180deg, rgba(15,23,42,0.92), rgba(15,23,42,0.98));
      border-bottom: 1px solid rgba(148,163,184,0.35);
      backdrop-filter: blur(14px);
      -webkit-backdrop-filter: blur(14px);
      box-shadow: 0 10px 30px rgba(15,23,42,0.8);
    }
    .top-header h1{
      margin: 0;
      font-weight: 700;
      letter-spacing: .12em;
      text-transform: uppercase;
      font-size: clamp(1.05rem, 2vw, 1.4rem);
      color: var(--primary-200);
      text-shadow:
        0 0 10px rgba(56,189,248,0.8),
        0 0 24px rgba(37,99,235,0.9);
    }

    /* ================= KAIZEN BANNER (sticky 2) ================= */
    .kaizen-wrap{
      height: calc(var(--h-banner) + var(--gap-hb));
    }
    .kaizen-banner{
      position: sticky;
      top: var(--h-header);
      z-index: 1036;
      width: 100%;
      display:flex;
      justify-content:center;
      padding-top: var(--gap-hb);
    }
    .kb-surface{
      position: relative;
      width: 100%;
      max-width: var(--banner-maxw);
      height: var(--h-banner);
      border-radius: var(--radius);
      overflow: hidden;
      background:
        radial-gradient(circle at 0% 0%, rgba(56,189,248,0.25), transparent 55%),
        radial-gradient(circle at 100% 100%, rgba(59,130,246,0.35), transparent 55%),
        linear-gradient(135deg, #020617 0%, #0b1120 40%, #020617 100%);
      border: 1px solid rgba(56,189,248,0.45);
      box-shadow:
        0 12px 40px rgba(15,23,42,0.95),
        0 0 22px rgba(56,189,248,0.50);
    }

    .kb-layer{
      position:absolute;
      inset:0;
      pointer-events:none;
    }
    .kb-grid{
      background:
        linear-gradient(transparent 88%, rgba(37,99,235,0.4)),
        repeating-linear-gradient(to right, rgba(59,130,246,0.18) 0 1px, transparent 1px 20px),
        repeating-linear-gradient(to bottom, rgba(59,130,246,0.18) 0 1px, transparent 1px 20px);
      opacity:.6;
      mix-blend-mode:screen;
    }
    .kb-glow{
      background:
        radial-gradient(1200px 160px at 10% 120%, rgba(56,189,248,0.38), transparent 65%),
        radial-gradient(800px 140px at 90% -25%, rgba(59,130,246,0.45), transparent 65%);
      mix-blend-mode:screen;
      opacity:.9;
    }
    .kb-streak::before{
      content:"";
      position:absolute;
      left:-40%;
      top:-140%;
      width:80%;
      height:380%;
      transform: rotate(18deg);
      background: linear-gradient(90deg,
        rgba(8,47,73,0),
        rgba(125,211,252,0.2),
        rgba(191,219,254,0.6),
        rgba(125,211,252,0.2),
        rgba(8,47,73,0));
      filter: blur(6px);
      animation: kbSweep 11s linear infinite;
      opacity:.75;
    }
    @keyframes kbSweep{
      0%{ left:-45%; }
      100%{ left:105%; }
    }

    .kb-inner{
      position: relative;
      height: 100%;
      display:flex;
      align-items:center;
      justify-content:center;
      padding: 0 24px;
    }
    .kb-text{
      text-align:center;
      line-height:1.1;
    }
    .kb-title-1,
    .kb-title-2{
      margin:0;
      text-transform:uppercase;
      letter-spacing:.14em;
      font-weight:500;
      color: var(--primary-200);
      text-shadow:
        0 0 10px rgba(56,189,248,0.9),
        0 0 30px rgba(37,99,235,0.9);
    }
    .kb-title-1{
      font-size: clamp(0.9rem, 1.55vw, 1.1rem);
    }
    .kb-title-2{
      margin-top: 4px;
      font-size: clamp(0.82rem, 1.45vw, 1.02rem);
    }
    .kb-5s{
      margin-top: 4px;
      font-size: clamp(0.7rem, 1.25vw, 0.9rem);
      color: #e0f2fe;
      opacity:.96;
    }
    .kb-5s span{
      color: #7dd3fc;
    }

    /* ================= NAVBAR (sticky 3) – Glass / Neon ================= */
    .navbar-dark.bg-dark{
      position: sticky;
      top: calc(var(--h-header) + var(--gap-hb) + var(--h-banner) + var(--gap-bm));
      z-index: 1032;
      margin: 0 auto;
      max-width: var(--banner-maxw);
      border-radius: var(--radius);
      border: 1px solid rgba(148,163,184,0.35);
      background:
        radial-gradient(circle at 0% 0%, rgba(56,189,248,0.15), transparent 55%),
        radial-gradient(circle at 100% 0%, rgba(37,99,235,0.22), transparent 55%),
        rgba(15,23,42,0.92) !important;
      backdrop-filter: blur(16px);
      -webkit-backdrop-filter: blur(16px);
      box-shadow:
        0 10px 30px rgba(15,23,42,0.90),
        0 0 22px rgba(15,118,190,0.45);
    }

    .navbar-nav .nav-link{
      position: relative;
      padding-inline: 14px;
      padding-block: 8px;
      font-size: 0.82rem;
      letter-spacing: .06em;
      text-transform: uppercase;
      color: #e5e7eb;
      opacity: .86;
      transition: color .18s ease, opacity .18s ease, transform .18s ease;
    }
    .navbar-nav .nav-link:hover{
      opacity: 1;
      color: var(--primary-200);
      transform: translateY(-1px);
    }
    .navbar-nav .nav-link::after{
      content:"";
      position:absolute;
      left:18%;
      right:18%;
      bottom:4px;
      height:0;
      border-radius:999px;
      background: linear-gradient(90deg, #22d3ee, #60a5fa, #22d3ee);
      box-shadow:none;
      opacity:0;
      transition:
        height .18s ease,
        opacity .18s ease,
        box-shadow .18s ease;
    }
    .navbar-nav .nav-link.active::after,
    .navbar-nav .nav-link:hover::after{
      height:3px;
      opacity:1;
      box-shadow:0 0 12px rgba(56,189,248,0.9);
    }
    .navbar-nav .nav-link.active{
      color: var(--primary-200) !important;
      opacity: 1;
    }

    /* ================= CONTENT & IFRAMES (SPA-like) ================= */
    .content-wrapper{
      flex:1;
      display:flex;
      flex-direction:column;
      background: transparent;
      padding-top: 10px;
    }
    .frame-wrap{
      flex:1;
      position:relative;
      max-width: var(--banner-maxw);
      margin: 0 auto 14px auto;
      border-radius: 14px;
      border: 1px solid rgba(15,23,42,0.9);
      background: radial-gradient(circle at 50% 0%, rgba(30,64,175,0.65), transparent 60%),
                  radial-gradient(circle at 0% 100%, rgba(8,47,73,0.85), transparent 60%),
                  #020617;
      box-shadow:
        0 18px 45px rgba(15,23,42,0.95),
        0 0 25px rgba(15,23,42,1);
      overflow:hidden;
    }

    iframe{
      position:absolute;
      inset:0;
      width:100%;
      height:100%;
      border:none;
      background: radial-gradient(circle at 50% 0%, rgba(30,64,175,0.3), transparent 60%),
                  #020617;
      opacity:0;
      pointer-events:none;
      transition: opacity .25s ease-out;
    }
    iframe.active{
      opacity:1;
      pointer-events:auto;
    }

    /* ================= BOTTOM NAV – MOBILE ================= */
    .bottom-nav{
      position: fixed;
      left:0; right:0; bottom:0;
      height: 60px;
      background: var(--bottom-bg);
      border-top: 1px solid var(--bottom-border);
      display: none;
      z-index: 1035;
      border-top-left-radius: 14px;
      border-top-right-radius: 14px;
      backdrop-filter: blur(16px);
      -webkit-backdrop-filter: blur(16px);
      box-shadow: 0 -6px 18px rgba(15,23,42,0.9);
    }
    .bottom-nav .bn-inner{
      height:100%;
      display:grid;
      grid-template-columns: repeat(5, 1fr);
      align-items:center;
    }
    .bn-btn{
      height:100%;
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      font-size: 0.68rem;
      color: var(--muted);
      text-decoration:none;
      gap: 2px;
      transition: color .16s ease, background .16s ease, transform .16s ease;
    }
    .bn-btn .bi{
      font-size: 1.18rem;
      line-height:1;
    }
    .bn-btn.active,
    .bn-btn:hover{
      color: var(--primary-200);
      background: var(--active-pill);
      transform: translateY(-1px);
    }

    @media (max-width: 991.98px){
      .bottom-nav{ display:block; }
      .content-wrapper{ padding-bottom: 70px; }
      .kb-title-1,
      .kb-title-2{
        letter-spacing: .10em;
      }
    }

    @media (max-width: 575.98px){
      :root{
        --h-banner: 70px;
      }
      .kb-5s{ display:none; }
      .frame-wrap{
        margin-inline: 8px;
        border-radius: 12px;
      }
      .navbar-nav .nav-link{
        font-size: 0.75rem;
        padding-inline: 10px;
      }
    }

    /* ================= Scrollbar ================= */
    *::-webkit-scrollbar { width: 9px; height: 9px; }
    *::-webkit-scrollbar-thumb { background: #1f2937; border-radius: 999px; }
    *::-webkit-scrollbar-thumb:hover { background: #334155; }
    *::-webkit-scrollbar-track { background: #020617; }
  </style>
</head>

<body>

  <!-- HEADER -->
  <header class="top-header">
    <h1>TỔ CƠ ĐIỆN</h1>
  </header>

  <!-- KAIZEN BANNER -->
  <div class="kaizen-wrap">
    <div class="kaizen-banner">
      <div class="kb-surface">
        <div class="kb-layer kb-grid"></div>
        <div class="kb-layer kb-glow"></div>
        <div class="kb-layer kb-streak"></div>

        <div class="kb-inner container-fluid">
          <div class="kb-text">
            <div class="kb-title-1">CHỦ ĐỘNG ✦ SÁNG TẠO ✦ HIỆU QUẢ</div>
            <div class="kb-title-2">KAIZEN - KHÔNG NGỪNG CẢI TIẾN</div>
            <div class="kb-5s">
              Seiri <span>(Sàng lọc)</span> •
              Seiton <span>(Sắp xếp)</span> •
              Seiso <span>(Sạch sẽ)</span> •
              Seiketsu <span>(Săn sóc)</span> •
              Shitsuke <span>(Sẵn sàng)</span>
            </div>
          </div>
        </div>

      </div>
    </div>
  </div>

  <!-- NAVBAR (sticky 3) -->
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark shadow sticky-top">
    <div class="container-fluid">
      <button class="navbar-toggler collapsed" type="button"
              data-bs-toggle="collapse" data-bs-target="#navbar-content"
              aria-controls="navbar-content" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse" id="navbar-content">
        <ul class="navbar-nav me-auto mb-2 mb-lg-0">
          <li class="nav-item"><a class="nav-link" data-target="mainFrame" href="#">TRANG CHỦ</a></li>
          <li class="nav-item"><a class="nav-link iframe-link" data-target="taskListFrame" href="#">BẢNG CÔNG VIỆC</a></li>
          <li class="nav-item"><a class="nav-link iframe-link" data-target="planListFrame" href="#">DỰ KIẾN</a></li>
          <li class="nav-item"><a class="nav-link iframe-link" data-target="maintListFrame" href="#">BẢO DƯỠNG</a></li>
          <li class="nav-item"><a class="nav-link iframe-link" data-target="MTCVFrame" href="#">PHÂN CÔNG</a></li>
          <li class="nav-item"><a class="nav-link iframe-link" data-target="WaterRecordFrame" href="#">CHỈ SỐ NƯỚC</a></li>
          <li class="nav-item"><a class="nav-link iframe-link" data-target="TaskReportFrame" href="#">BÁO CÁO</a></li>
          <li class="nav-item"><a class="nav-link iframe-link" data-target="chamcongFrame" href="#">CHẤM CÔNG</a></li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- CONTENT + IFRAMES -->
  <div class="content-wrapper">
    <div class="frame-wrap">
      <!-- Trang chủ có thể là một dashboard tĩnh sau -->
      <iframe id="mainFrame" src="" class="active"></iframe>

      <!-- Lazy-load các iframe khác bằng data-src -->
      <iframe id="taskListFrame"
        data-src="https://script.google.com/macros/s/AKfycbyHry8Kk9_0ZyCfy3nZhVIrxKrENmSf5vsnPW-xxoUUbxRuOg1wYcUjdnT9x3i9urw/exec"></iframe>

      <iframe id="planListFrame"
        data-src="https://script.google.com/macros/s/AKfycby6kstI0YU3rdAR7txXXudD_83JET2x7AzFzufPdOmxuz4xS0M35tsGn4i1z9CGXA-C/exec"></iframe>

      <iframe id="maintListFrame"
        data-src="https://script.google.com/macros/s/AKfycbxeuGMrHlOt03JdRXAeU-JBQn-hoOF0SOuX1_gH9VAGZ6dxQ8HOqnb9WGvn5ZOH1mCt9g/exec"></iframe>

      <iframe id="MTCVFrame"
        data-src="https://script.google.com/macros/s/AKfycbyK1iyc0eck7seY7kqmGOb6V1MYVv_Ue43q2dYzKFeby329xHaQBtFj2WdDweW46NLA/exec"></iframe>

      <iframe id="WaterRecordFrame"
        data-src="https://script.google.com/macros/s/AKfycbwTbLHDiGjq4rcUwb6b6MLBM_junEEcJdVAlzZt1C25phiwIQG4uBnSEqpFu98I1wE/exec"></iframe>

      <iframe id="TaskReportFrame"
        data-src="https://script.google.com/macros/s/AKfycbzwCj7p9fYzDMmeoEMnmdSmG__XTMAdEoBi17GLPR-r5gPXpoiypiK7GVdK3yodP0iT/exec"></iframe>

      <iframe id="DXVTFrame"
        data-src="https://script.google.com/macros/s/AKfycbzrrIMJ4N5ymEMEV6EkOQy2qTH1ApZtdb4bn8h1sLPbCUE-upwxxlW-tvyNWOzAuwmX/exec"></iframe>

      <iframe id="MotorCurrentFrame"
        data-src="https://script.google.com/macros/s/AKfycbxpHonjPCZ9Vin42ZATGEPGD09XWZ8MI76MI1kuE3lwHKV09_Yb_XeL193SVvnrSthe/exec"></iframe>

      <iframe id="chamcongFrame"
        data-src="https://script.google.com/macros/s/AKfycbxG7IU2Nvv4IFmmcZnu4N_SWaNAKRYnNzElRan5ZiAaNqjb2GRdRpg-yyYCIZ95Gc6y2w/exec"></iframe>

      <iframe id="bearingFrame"
        data-src="https://script.google.com/macros/s/AKfycbww7MA7xaZG2UJQWAc0NBwbl-bZPcjmic5XOUDFk_NR7OylFdv3OG2rxUUXRGy1w1BD/exec"></iframe>

      <iframe id="vbeltsFrame" data-src=""></iframe>
    </div>
  </div>

  <!-- BOTTOM NAV – MOBILE -->
  <nav class="bottom-nav d-lg-none">
    <div class="bn-inner">
      <a href="#" class="bn-btn" data-target="mainFrame">
        <i class="bi bi-house"></i><div>Trang chủ</div>
      </a>
      <a href="#" class="bn-btn" data-target="taskListFrame">
        <i class="bi bi-card-checklist"></i><div>Công việc</div>
      </a>
      <a href="#" class="bn-btn" data-target="planListFrame">
        <i class="bi bi-calendar-event"></i><div>Dự kiến</div>
      </a>
      <a href="#" class="bn-btn" data-target="maintListFrame">
        <i class="bi bi-gear"></i><div>Bảo dưỡng</div>
      </a>
      <a href="#" class="bn-btn" data-target="TaskReportFrame">
        <i class="bi bi-graph-up"></i><div>Báo cáo</div>
      </a>
    </div>
  </nav>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" defer></script>

  <!-- APP SCRIPT: SPA Router + Lazy-load iframe -->
  <script>
    window.addEventListener('DOMContentLoaded', function () {
      const menuLinks  = document.querySelectorAll('.iframe-link, .nav-link[data-target]');
      const bottomBtns = document.querySelectorAll('.bottom-nav .bn-btn[data-target]');
      const frames     = document.querySelectorAll('iframe');

      /* Navbar collapse (mobile) */
      const navbarCollapseEl = document.getElementById('navbar-content');
      const navCollapse      = navbarCollapseEl ? new bootstrap.Collapse(navbarCollapseEl, { toggle: false }) : null;

      function collapseIfMobile() {
        if (!navCollapse) return;
        if (window.matchMedia('(max-width: 991.98px)').matches) navCollapse.hide();
      }

      function setActiveLink(targetId){
        menuLinks.forEach(l => {
          const t = l.getAttribute('data-target');
          l.classList.toggle('active', t === targetId);
        });
        bottomBtns.forEach(b => {
          const t = b.getAttribute('data-target');
          b.classList.toggle('active', t === targetId);
        });
      }

      function ensureFrameLoaded(frameEl){
        if (!frameEl) return;
        if (!frameEl.getAttribute('src')) {
          const dataSrc = frameEl.getAttribute('data-src');
          if (dataSrc) frameEl.setAttribute('src', dataSrc);
        }
      }

      function activateFrame(targetId) {
        frames.forEach(f => f.classList.remove('active'));
        const target = document.getElementById(targetId);
        if (target) {
          ensureFrameLoaded(target);
          target.classList.add('active');
        }
        try { localStorage.setItem('lastFrameId', targetId); } catch (e) {}
        setActiveLink(targetId);
      }

      function handleClick(e){
        e.preventDefault();
        const targetId = this.getAttribute('data-target');
        if (!targetId) return;
        activateFrame(targetId);
        collapseIfMobile();
      }

      menuLinks.forEach(link => link.addEventListener('click', handleClick));
      bottomBtns.forEach(btn => btn.addEventListener('click', handleClick));

      /* Khôi phục iframe lần cuối cùng, hoặc mặc định mainFrame */
      let defaultFrame = 'mainFrame';
      try {
        const saved = localStorage.getItem('lastFrameId');
        if (saved && document.getElementById(saved)) defaultFrame = saved;
      } catch (e) {}
      activateFrame(defaultFrame);
    });
  </script>
</body>
</html>
